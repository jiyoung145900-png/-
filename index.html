<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOBLESSE | í”„ë¦¬ë¯¸ì—„ ì½”ìŠ¤ ê°€ê²©í‘œ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* --- 1. ë…¸ë¸”ë ˆìŠ¤ í…Œë§ˆ ì„¤ì • --- */
        :root {
            --primary-gold: #c5a059;
            --dark-gold: #a67c37;
            --luxury-navy: #0a192f;
            --deep-black: #050505;
            --soft-white: #f8f9fa;
        }

        body { 
            font-family: 'Times New Roman', 'Malgun Gothic', serif;
            margin: 0; padding: 0; display: flex; justify-content: center; 
            background-color: #1a1a1a; color: var(--soft-white);
        }
        
        .phone-container { position: relative; display: flex; justify-content: center; margin-top: 20px; }
        
        .phone-frame {
            width: 600px; height: 1100px; overflow-y: auto; 
            background-color: var(--luxury-navy);
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
            border: 4px solid var(--primary-gold);
            border-radius: 30px; padding: 40px 30px; box-sizing: border-box;
            position: relative;
        }

        /* ë°°ê²½ ë¡œê³ /ì´ë¯¸ì§€ ì„¤ì • */
        #main-background {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; opacity: 0.15;
            background-image: url('https://www.transparenttextures.com/patterns/dark-matter.png'); /* ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ì§ˆê° */
        }
        
        #course-list-view, #detail-view, #admin-view { position: relative; z-index: 1; }

        /* --- 2. ë…¸ë¸”ë ˆìŠ¤ ìŠ¤íƒ€ì¼ UI ìš”ì†Œ --- */
        .course-list-header { 
            color: var(--primary-gold); text-align: center; 
            font-size: 2.2em; letter-spacing: 5px; margin-bottom: 40px;
            border-bottom: 1px solid var(--primary-gold); padding-bottom: 20px;
        }

        .course-item { 
            background: linear-gradient(135deg, #112240 0%, #0a192f 100%);
            border: 1px solid var(--primary-gold); padding: 25px; margin-bottom: 20px; 
            border-radius: 5px; display: flex; justify-content: space-between; align-items: center; 
            cursor: pointer; transition: all 0.3s ease;
        }
        .course-item:hover { transform: scale(1.02); background-color: #1d2d50; border-width: 2px; }

        .course-item .course-title { font-size: 1.4em; font-weight: bold; color: var(--soft-white); }
        .course-item .course-price { font-size: 1.3em; color: var(--primary-gold); font-weight: bold; }

        /* ìƒì„¸ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        #detail-view h3 { color: var(--primary-gold); text-align: center; font-size: 1.8em; }
        .option-item { 
            background: rgba(255,255,255,0.05); padding: 15px; margin-bottom: 10px;
            border-radius: 4px; display: flex; align-items: center;
        }
        .option-item label { flex-grow: 1; cursor: pointer; }
        .option-item input[type="checkbox"] { accent-color: var(--primary-gold); margin-right: 15px; }

        #total-display { 
            margin-top: 30px; padding: 20px; background: var(--primary-gold); 
            color: var(--luxury-navy); border-radius: 5px; font-weight: bold;
            display: flex; justify-content: space-between; font-size: 1.2em;
        }

        /* --- 3. ì œì–´ ë²„íŠ¼ ê·¸ë£¹ (ìš°ì¸¡ ìƒë‹¨ ê³ ì •) --- */
        #control-buttons {
            position: fixed; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 1000;
        }
        #control-buttons button {
            padding: 12px 20px; border: 1px solid var(--primary-gold); background: #000;
            color: var(--primary-gold); cursor: pointer; font-weight: bold; border-radius: 4px;
            transition: 0.3s; width: 160px;
        }
        #control-buttons button:hover { background: var(--primary-gold); color: #000; }
        .admin-mode-active { background: #ff4d4d !important; color: white !important; border-color: #ff4d4d !important; }

        /* --- 4. ê²¬ì ì„œ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ --- */
        .modal-content { 
            background-color: var(--luxury-navy); color: var(--soft-white);
            padding: 40px; border: 2px solid var(--primary-gold); border-radius: 0;
            width: 450px; text-align: center;
        }
        .quote-header h3 { color: var(--primary-gold); font-size: 2em; border-bottom: 2px solid var(--primary-gold); padding-bottom: 10px; }
        .final-total .total-price { font-size: 3em; color: var(--primary-gold); margin-top: 10px; }

        /* ê´€ë¦¬ì í¸ì§‘ í¼ ìŠ¤íƒ€ì¼ */
        #admin-view { background: #112240; padding: 20px; border: 1px dashed var(--primary-gold); }
        .admin-course-item { background: #0a192f; border: 1px solid #333; padding: 15px; margin-bottom: 15px; }
        input[type="text"], input[type="number"] { background: #000; border: 1px solid var(--primary-gold); color: white; padding: 8px; margin: 5px 0; }
    </style>
</head>
<body>

<div id="control-buttons">
    <button id="toggle-admin-btn" onclick="toggleAdminMode()">âš™ï¸ í¸ì§‘ ëª¨ë“œ</button>
    <button id="save-admin-changes-btn" onclick="saveAdminChanges()" style="display:none; background: #28a745; color: white;">âœ… ë³€ê²½ì‚¬í•­ ì €ì¥</button>
    <button id="capture-list-btn" onclick="captureFrameAsPNG('phone-frame-capture')">ğŸ“¸ ëª©ë¡ ìº¡ì²˜</button>
    <button id="show-quote-btn" class="detail-only" style="display:none;" onclick="showFinalQuote()">ğŸ’¸ ê²¬ì ì„œ í™•ì¸</button>
    <button id="capture-quote-btn" class="detail-only" style="display:none;" onclick="captureQuoteAsPNG()">ğŸ“· ê²¬ì ì„œ ìº¡ì²˜</button>
</div>

<div class="phone-container">
    <div class="phone-frame" id="phone-frame-capture">
        <div id="main-background"></div>
        
        <div id="course-list-view">
            <h1 class="course-list-header">NOBLESSE</h1>
            <p style="text-align:center; color: var(--primary-gold); letter-spacing: 2px; margin-top:-30px; margin-bottom:40px;">PREMIUM PRIVATE SERVICE</p>
            <div id="course-items-container"></div>
        </div>

        <div id="admin-view" style="display:none;">
            <h3 style="color: var(--primary-gold);">KEY: DATA MANAGEMENT</h3>
            <div id="admin-course-editor"></div>
            <button onclick="addNewCourse(event)" style="width:100%; padding:15px; background:var(--primary-gold); border:none; margin-top:10px; cursor:pointer; font-weight:bold;">+ ìƒˆ ì½”ìŠ¤ ì¶”ê°€</button>
        </div>

        <div id="detail-view" style="display:none;">
            <h3 id="detail-title-selected"></h3>
            <p style="text-align:center; opacity:0.8;">[<span id="detail-time-selected"></span> | ê¸°ë³¸: â‚© <span id="detail-price-selected-val"></span>]</p>
            <hr style="border-color: var(--primary-gold); margin:20px 0;">
            <div id="options-list"></div>
            <div id="total-display">
                <span>TOTAL AMOUNT</span>
                <span id="current-total-price">â‚© 0</span>
            </div>
            <button onclick="showCourseList()" style="width:100%; background:none; border:1px solid var(--primary-gold); color:var(--primary-gold); padding:15px; margin-top:20px; cursor:pointer;">â† BACK TO LIST</button>
        </div>
    </div>
</div>

<div id="final-quote-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:2000; justify-content:center; align-items:center;">
    <div class="modal-content" id="modal-capture-target">
        <div class="quote-header">
            <h3>NOBLESSE QUOTE</h3>
        </div>
        <div id="quote-details-content" style="text-align:left; padding:20px 0; line-height:1.8;"></div>
        <div class="final-total">
            <p style="margin-bottom:0; opacity:0.7;">FINAL SUM</p>
            <div class="total-price">â‚© <span id="modal-total-price">0</span></div>
        </div>
        <button id="modal-close-btn" onclick="closeFinalQuoteModal()" style="background:none; border:1px solid var(--primary-gold); color:var(--primary-gold); padding:10px 30px; margin-top:30px; cursor:pointer;">CLOSE</button>
    </div>
</div>

<script>
    /* --- JS ë¡œì§ì€ ê¸°ì¡´ ë°ì´ì§€ ì†ŒìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ë…¸ë¸”ë ˆìŠ¤ ìŠ¤íƒ€ì¼ì— ë§ê²Œ ë°ì´í„°ì™€ ë Œë”ë§ ìœ ì§€ --- */
    const INITIAL_COURSES = {
        'platinum': { title: 'PLATINUM', time: '120 MIN', basePrice: 200000, options: [{name: 'ìµœê³ ê¸‰ ì™€ì¸ ì„œë¹„ìŠ¤', price: 50000}, {name: 'í”½ì—… ì„œë¹„ìŠ¤', price: 30000}] },
        'black': { title: 'BLACK', time: '240 MIN', basePrice: 400000, options: [{name: 'ì „ë‹´ ë¹„ì„œ ì¼€ì–´', price: 100000}, {name: 'í”„ë¼ì´ë¹— ë£¸ ì—…ê·¸ë ˆì´ë“œ', price: 50000}] }
    };

    let coursesData;
    let currentSelectedCourseKey = null;
    let isEditingMode = false;
    const formatPrice = (p) => p.toLocaleString('ko-KR');

    // ë°ì´í„° ë¡œë“œ
    function loadData() {
        const saved = localStorage.getItem('noblesseData');
        coursesData = saved ? JSON.parse(saved) : INITIAL_COURSES;
    }

    // ëª©ë¡ ë Œë”ë§
    function renderList() {
        const container = document.getElementById('course-items-container');
        let html = '';
        for (const key in coursesData) {
            html += `
                <div class="course-item" onclick="selectCourse('${key}')">
                    <div class="course-title">${coursesData[key].title}</div>
                    <div class="course-price">â‚© ${formatPrice(coursesData[key].basePrice)}</div>
                </div>`;
        }
        container.innerHTML = html;
    }

    function selectCourse(key) {
        currentSelectedCourseKey = key;
        const c = coursesData[key];
        document.getElementById('course-list-view').style.display = 'none';
        document.getElementById('detail-view').style.display = 'block';
        document.getElementById('detail-title-selected').textContent = c.title + " COURSE";
        document.getElementById('detail-time-selected').textContent = c.time;
        document.getElementById('detail-price-selected-val').textContent = formatPrice(c.basePrice);
        
        // ë²„íŠ¼ ì œì–´
        document.querySelectorAll('.detail-only').forEach(b => b.style.display = 'block');
        
        let optHtml = '<h4>ADDITIONAL OPTIONS</h4>';
        c.options.forEach((o, i) => {
            optHtml += `
                <div class="option-item">
                    <input type="checkbox" id="o-${i}" data-price="${o.price}" onchange="updateTotal()">
                    <label for="o-${i}">${o.name} (+â‚©${formatPrice(o.price)})</label>
                </div>`;
        });
        document.getElementById('options-list').innerHTML = optHtml;
        updateTotal();
    }

    function updateTotal() {
        let total = coursesData[currentSelectedCourseKey].basePrice;
        document.querySelectorAll('#options-list input:checked').forEach(cb => {
            total += parseInt(cb.dataset.price);
        });
        document.getElementById('current-total-price').textContent = 'â‚© ' + formatPrice(total);
    }

    function showCourseList() {
        document.getElementById('course-list-view').style.display = 'block';
        document.getElementById('detail-view').style.display = 'none';
        document.querySelectorAll('.detail-only').forEach(b => b.style.display = 'none');
    }

    function showFinalQuote() {
        const c = coursesData[currentSelectedCourseKey];
        let total = c.basePrice;
        let optList = '';
        document.querySelectorAll('#options-list input:checked').forEach(cb => {
            total += parseInt(cb.dataset.price);
            optList += `<li>- ${cb.nextElementSibling.textContent}</li>`;
        });

        document.getElementById('quote-details-content').innerHTML = `
            <p><strong>COURSE:</strong> ${c.title}</p>
            <p><strong>TIME:</strong> ${c.time}</p>
            <ul style="list-style:none; padding:0; border-top:1px solid #333; padding-top:10px;">
                ${optList || '<li>No options selected</li>'}
            </ul>
        `;
        document.getElementById('modal-total-price').textContent = formatPrice(total);
        document.getElementById('final-quote-modal').style.display = 'flex';
    }

    function closeFinalQuoteModal() { document.getElementById('final-quote-modal').style.display = 'none'; }

    // ìº¡ì²˜ ê¸°ëŠ¥ (ìƒˆ íƒ­ìœ¼ë¡œ ì—´ê¸°)
    function captureFrameAsPNG(id) {
        html2canvas(document.getElementById(id), { scale: 2, backgroundColor: '#0a192f' }).then(canvas => {
            const link = document.createElement('a');
            link.download = 'NOBLESSE_PRICE.png';
            link.href = canvas.toDataURL();
            link.click();
        });
    }

    function captureQuoteAsPNG() {
        const target = document.getElementById('modal-capture-target');
        document.getElementById('modal-close-btn').style.display = 'none';
        html2canvas(target, { scale: 2, backgroundColor: '#0a192f' }).then(canvas => {
            document.getElementById('modal-close-btn').style.display = 'block';
            const link = document.createElement('a');
            link.download = 'NOBLESSE_QUOTE.png';
            link.href = canvas.toDataURL();
            link.click();
        });
    }

    // ê´€ë¦¬ì í¸ì§‘ ê¸°ëŠ¥
    function toggleAdminMode() {
        isEditingMode = !isEditingMode;
        document.getElementById('admin-view').style.display = isEditingMode ? 'block' : 'none';
        document.getElementById('course-list-view').style.display = isEditingMode ? 'none' : 'block';
        document.getElementById('save-admin-changes-btn').style.display = isEditingMode ? 'block' : 'none';
        document.getElementById('toggle-admin-btn').classList.toggle('admin-mode-active');
        if(isEditingMode) renderAdminEditor();
    }

    function renderAdminEditor() {
        let html = '';
        for (const key in coursesData) {
            const c = coursesData[key];
            html += `
                <div class="admin-course-item">
                    <input type="text" value="${c.title}" onchange="coursesData['${key}'].title=this.value">
                    <input type="text" value="${c.time}" onchange="coursesData['${key}'].time=this.value">
                    <input type="number" value="${c.basePrice}" onchange="coursesData['${key}'].basePrice=parseInt(this.value)">
                    <button onclick="deleteCourse('${key}')" style="background:#ff4d4d; border:none; color:white; padding:5px; cursor:pointer;">ì½”ìŠ¤ ì‚­ì œ</button>
                </div>`;
        }
        document.getElementById('admin-course-editor').innerHTML = html;
    }

    function saveAdminChanges() {
        localStorage.setItem('noblesseData', JSON.stringify(coursesData));
        alert("âœ… ë…¸ë¸”ë ˆìŠ¤ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
        toggleAdminMode();
        renderList();
    }

    window.onload = () => { loadData(); renderList(); };
</script>
</body>
</html>
